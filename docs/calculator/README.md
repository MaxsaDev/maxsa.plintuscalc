# Калькулятор плинтуса - Документація

## Огляд

Калькулятор для розрахунку кількості плинтуса та аксесуарів для його монтажу. Призначений для дюрополімерних плинтусів (plintus_types_id = 1).

## Формули розрахунку

### 1. Кількість планок плинтуса

```
Планки = CEIL((Периметр × 1000 × 1.05) / Довжина_планки_мм)
```

**Пояснення:**
- Периметр конвертується з метрів у міліметри (× 1000)
- Додається 5% запас для зарізів (× 1.05)
- Результат округлюється вгору (CEIL)

**Приклад:**
- Периметр: 100 м
- Довжина планки: 2000 мм
- Розрахунок: (100 × 1000 × 1.05) / 2000 = 105000 / 2000 = 52.5 → **53 планки**

### 2. Монтажний клей

```
Монтажний_клей = CEIL(Периметр / 8)
```

**Пояснення:**
- Один тюбик монтажного клею на 8 метрів периметра
- Округлення вгору

**Приклад:**
- Периметр: 100 м
- Розрахунок: 100 / 8 = 12.5 → **13 тюбиків**

### 3. Клей для з'єднань

```
Клей_з'єднань = CEIL(Монтажний_клей / 6)
```

**Пояснення:**
- Один тюбик клею для з'єднань на 6 тюбиків монтажного клею
- Округлення вгору

**Приклад:**
- Монтажний клей: 13 тюбиків
- Розрахунок: 13 / 6 = 2.17 → **3 тюбики**

### 4. Шпатлівка

```
Базова_шпатлівка = CEIL(Монтажний_клей / 6)
Додаткова_шпатлівка = FLOOR(Клей_з'єднань / 3)
Шпатлівка = Базова_шпатлівка + Додаткова_шпатлівка
```

**Пояснення:**
- Базова шпатлівка: один тюбик на 6 тюбиків монтажного клею (округлення вгору)
- Додаткова шпатлівка: відсікання дробової частини від клею для з'єднань / 3
- Загальна кількість = сума обох значень

**Приклад:**
- Монтажний клей: 13 тюбиків
- Клей з'єднань: 3 тюбики
- Базова: CEIL(13 / 6) = 3
- Додаткова: FLOOR(3 / 3) = 1
- **Разом: 4 тюбики**

## Структура компонентів

### Основна сторінка (`app/page.tsx`)

**Layout структура:**
```
<div className="flex h-screen flex-col">
  <div className="flex flex-1 flex-col overflow-y-auto lg:flex-row">
    {/* Ліва колонка - Форма */}
    {/* Права колонка - Результати */}
  </div>
  <FooterCopyright />
</div>
```

**Ключові технічні рішення:**

1. **Derived State для розрахунків:**
   - Результати розрахунків обчислюються як похідні значення від `selectedPlintus` та `perimeterLength`
   - Не використовується `useState` + `useEffect` для уникнення cascading renders
   - Завжди показуються результати (з нульовими значеннями, якщо дані не введені)

2. **React Hook Form:**
   - Використовується `useWatch` для отримання значень форми
   - Валідація через Zod schema
   - Режим: `onChange` для миттєвої валідації

3. **Завантаження даних плинтуса:**
   - `useEffect` для завантаження даних обраного плинтуса
   - Завантаження відбувається при зміні `plintusId`

### Компонент вибору плинтуса (`PlintusSelect`)

**Особливості:**
- Використовує `Combobox` (Popover + Command) для пошуку серед великої кількості моделей
- Відображає назву та довжину в метрах: `"Назва (2.0 м)"`
- Великий розмір шрифту: `text-3xl` (1.875rem) через inline styles для перевизначення дефолтних стилів Button

### Компонент вводу периметра (`LengthInput`)

**Особливості:**
- Використовує звичайний `Input` з одиницею "м" справа
- Великий розмір шрифту: `text-3xl` (1.875rem) через inline styles
- `type="text"` з `inputMode="decimal"` для видалення стрілок інкременту
- Pattern: `[0-9]*\.?[0-9]*` для валідації десяткових чисел

### Компонент результатів (`CalculationResults`)

**Структура Item:**
```
<Item variant="outline" className="gap-3">
  <ItemMedia variant="image" className="size-16 shrink-0 self-start rounded-md border">
    {/* Зображення 64x64px */}
  </ItemMedia>
  <ItemContent>
    <ItemTitle>{name}</ItemTitle>
    <ItemDescription>{description}</ItemDescription>
    {/* Розміри для плинтуса: ДОВЖИНА x ВИСОТА x ШИРИНА мм */}
  </ItemContent>
  <ItemActions>
    {/* Ціна за одиницю (інформаційно) */}
    {/* Кількість (великий розмір) */}
  </ItemActions>
</Item>
```

**Особливості відображення:**

1. **Зображення:**
   - Розмір: 64x64px (size-16)
   - Границя зі скругленими краями (`rounded-md border`)
   - Вирівнювання по верху (`self-start`) незалежно від розміру контенту
   - Мінімальні відступи зліва (`gap-3`)

2. **Розміри плинтуса:**
   - Формат: `ДОВЖИНА x ВИСОТА x ШИРИНА мм`
   - Відображаються в міліметрах без конвертації
   - Стиль: `text-xs font-bold text-muted-foreground`

3. **Ціна:**
   - Відображається над кількістю як інформаційна строка
   - Формат: `"595 ₴ / тюб"`
   - Стиль: `text-xs text-muted-foreground`

4. **Кількість:**
   - Великий розмір: `text-5xl font-bold`
   - Tabular numbers для вирівнювання

**Summary блок:**
- Показує загальну кількість позицій, вартість та вагу
- Включає сноску з важливою інформацією про розрахунки

## Дизайнерські рішення

### Layout

**Двоколоночна структура:**
- **Ліва колонка (480px):** Форма вводу з темнішим фоном (`bg-muted/30`)
- **Права колонка (flex-1):** Результати розрахунків
- **Роздільник:** Вертикальна границя між колонками (`border-r`)

**Висота:**
- Зовнішній контейнер: `h-screen` (фіксована висота екрана)
- Основной контент: `flex-1` (займає доступний простір)
- Футер: `flex-shrink-0` (завжди видимий внизу)

### Кольорова схема

**Використання змінних теми Shadcn UI:**
- `bg-background` - основний фон
- `bg-muted/30` - фон лівої колонки
- `text-foreground` - основний текст
- `text-muted-foreground` - другорядний текст
- `border-border` - границі

**Акценти:**
- Primary кольори для іконок та badge'ів
- Chart кольори (chart-1, chart-2, chart-3, chart-4) для різних типів матеріалів

### Типографіка

**Заголовки:**
- H1: `text-4xl font-bold` (36px)
- H2: `text-3xl font-bold` (30px)
- H3: `text-xl font-semibold` (20px)

**Текст:**
- Основний: `text-base` (16px)
- Другорядний: `text-sm` (14px)
- Малий: `text-xs` (12px)

**Спеціальні розміри:**
- Введення даних: `text-3xl` (1.875rem / 30px) через inline styles
- Кількість в результатах: `text-5xl` (48px)

### Відступи та простір

**Стандартні відступи:**
- Між секціями: `space-y-12` (48px)
- Між полями форми: `space-y-8` (32px)
- Між елементами: `space-y-3` (12px)
- Між результатами: `space-y-6` (24px)

**Padding:**
- Ліва колонка: `p-8 lg:p-12` (32px / 48px)
- Права колонка: `p-8 lg:p-12` (32px / 48px)
- Картки: `p-6` (24px)

## Валідація

### Zod Schema (`schemas/plintus-calculator.ts`)

```typescript
{
  plintusId: string (UUID) - обов'язкове
  perimeterLength: number
    - обов'язкове
    - позитивне число
    - мінімум: 0.1 м
    - максимум: 10000 м
}
```

## База даних

### Структура даних плинтуса

**Таблиця:** `mx_data.plintus_data`

**Поля:**
- `id` (UUID) - ідентифікатор
- `plintus_types_id` (number) - тип плинтуса (1 = дюрополімер)
- `title` (string) - назва моделі
- `image_path` (string) - шлях до зображення
- `price` (string) - ціна
- `weight` (string) - вага
- `length` (string) - довжина в мм
- `width` (string) - ширина в мм
- `height` (string) - висота в мм

**Важливо:**
- Всі розміри зберігаються в міліметрах
- Периметр вводиться в метрах
- Конвертація відбувається в формулах розрахунку

## Константи

### `lib/const.ts`

```typescript
APP_PATH = 'https://plintus.ua/image/' // Базовий URL для зображень
CURRENT_VERSION = '1.0.0' // Версія додатку
```

## Примітки

1. **Розрахунки виконуються на основі цін і ваги з сайту** - можливі тимчасові розбіжності при оновленні даних
2. **Кількість плинтусів розрахована із запасом** - для зарізання кутів, стиків і компенсації нерівностей
3. **Фінальну ціну та вагу рекомендується уточнювати** на сайті або у менеджера

